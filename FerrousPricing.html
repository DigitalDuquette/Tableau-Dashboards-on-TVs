



<html lang="en">

<head>
    <title>_view-name-here_</title>
    <!--
        Purpose: 
            Create refresh of data from Tableau server.  Details in code. 
    -->
    <script type="text/javascript" src="https://tableau.padnos.com/javascripts/api/tableau-2.min.js"></script>
    <!--JS API on Tableau Server -->
</head>


<body id="page-wrap">
    <style>
        html, body { height: 100%; background-color: black }

    </style>
    <!--Div element for viz. Viz generated by script -->
    
    <div id= "tableauViz" ></div> 
    

    <script type='text/javascript'>
        // Script generated following API documentation from Tableau:
        // https://onlinehelp.tableau.com/current/api/js_api/en-us/JavaScriptAPI/js_api_concepts_initializing.htm
        
        //Initialize the API by using the object model.  Create object, then instantiate.  (reverse from Tableau doc)

        //Create a new Viz object 
        var placeholderDiv = document.getElementById("tableauViz");
        var url = ''
            //URL must match https://my-server/views/my-workbook/my-view NOTE: no # or session identifier in URL string  
        var options = 
            { //var options follows API documentation.  
                hideTabs: true,
                hideToolbar: true,
                width: "100%", 
                height: "100%",  
                onFirstInteractive: function() 
                {
                    //now safe to use viz via API function(s)
                }
            }; //end var options 
        
        //instantiate new viz object 
        var viz = new tableau.Viz(placeholderDiv, url, options);

        //Set the refresh interval on object function in ms 
        // 3600000 == 60 min
        // 7200000 == 120 min
        // 10800000 == 180 min
        // start with 180 min as min, reduce as needed. 
        setInterval(function () {viz.refreshDataAsync() }, 10800000);

    </script>
</body>